import glob,os
import win32api,win32file
import time

def getFixedDrives():
	# list all available drives
	drives=win32api.GetLogicalDriveStrings()
	drives=drives.split("\000")

	# built a list of the fixed drives
	fixedDrives=[]
	for d in drives:
		if d and win32file.GetDriveType(d)==win32file.DRIVE_FIXED: fixedDrives.append(d)
	return fixedDrives

def findInPath(fileToSearch,searchPath='C:\\',maxWildcards=5):
	searchPath=searchPath
	fileToSearch=fileToSearch
	nbWildcards=0
	maxWildcards=maxWildcards
	found=glob.glob(os.path.join(searchPath,fileToSearch))
	while found==[] and (maxWildcards-nbWildcards)>=0:
		searchPath=os.path.join(searchPath,'*')
		nbWildcards+=1
		found=glob.glob(os.path.join(searchPath,fileToSearch))
	if found!=[]:return found
	else:return None

def find(file,path="/",maxVisitedDirectories=3):
	dirEntries=[]
	if path=="/":
		# search from the root
		dirEntries=getFixedDrives()
	else:
		dirEntries=[path,]

	pathFound=None
	i=0
	while i<len(dirEntries) and pathFound is None:
		pathFound=findInPath(file,dirEntries[i],maxVisitedDirectories)
	if pathFound is not None: return os.path.split(pathFound[0])
	else: return None
	