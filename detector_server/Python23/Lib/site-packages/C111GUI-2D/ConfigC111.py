# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'Y:\linux\drivers\c111\V38WQN~T.8\CSC3S0~F\ConfigC111.ui'
#
# Created: lun. 12. d√©c. 15:09:43 2005
#      by: The PyQt User Interface Compiler (pyuic) 3.8
#
# WARNING! All changes made in this file will be lost!

from qt import *
import sys, os, string
import c111
import ConfigParser
from c111cfg import C111Cfg
from c111globals import C111Globals

DBG = 0
#DBG = 1

class ConfigC111Dialog(QDialog):
    def __init__(self,parent ,cfg,readonly=0,modal = 0,fl = 0):
        if( DBG == 1):
            print "ConfigC111Dialog.init: CFG NAME: ", cfg.GetName()
        QDialog.__init__(self,parent,cfg.GetName(),modal,fl)

        if not cfg:
            self.cfg = C111Cfg("New C111 Config")
            self.setName("New C111 Config Dialog")
        else:
            self.cfg = cfg
            self.setName(self.cfg.GetName() )
            self.setCaption(self.cfg.GetName() )

        self.readonly = readonly ;
        self.glob = C111Globals()
        self.setSizeGripEnabled(1)

        self.OperationTypeButtonGroup = QButtonGroup(self,"OperationTypeButtonGroup")
        self.OperationTypeButtonGroup.setGeometry(QRect(10,10,190,50))

        self.NormalRadioButton = QRadioButton(self.OperationTypeButtonGroup,"NormalRadioButton")
        self.NormalRadioButton.setGeometry(QRect(40,20,70,20))

        self.TestRadioButton = QRadioButton(self.OperationTypeButtonGroup,"TestRadioButton")
        self.TestRadioButton.setGeometry(QRect(120,20,60,20))

        self.OffsetXGroupBox = QGroupBox(self,"OffsetXGroupBox")
        self.OffsetXGroupBox.setGeometry(QRect(220,20,150,40))

        self.OffsetXTextLabel = QLabel(self.OffsetXGroupBox,"OffsetXTextLabel")
        self.OffsetXTextLabel.setGeometry(QRect(70,10,60,25))

        self.OffsetXSpinBox = QSpinBox(self.OffsetXGroupBox,"OffsetXSpinBox")
        self.OffsetXSpinBox.setGeometry(QRect(10,10,50,20))
        self.OffsetXSpinBox.setMaxValue(999)

        self.CheckSettingsButtonGroup = QButtonGroup(self,"CheckSettingsButtonGroup")
        self.CheckSettingsButtonGroup.setGeometry(QRect(380,10,170,110))

        self.ResolutionComboBox = QComboBox(0,self.CheckSettingsButtonGroup,"ResolutionComboBox")
        self.ResolutionComboBox.setGeometry(QRect(10,20,151,21))
        self.ResolutionComboBox.setInsertionPolicy(QComboBox.AtCurrent)
        self.ResolutionComboBox.insertItem("Resolution: FULL")
        self.ResolutionComboBox.insertItem("Resolution: HALF")
        self.ResolutionComboBox.insertItem("Resolution: QUARTER")

        self.InterruptionTimerCheckBox = QCheckBox(self.CheckSettingsButtonGroup,"InterruptionTimerCheckBox")
        self.InterruptionTimerCheckBox.setGeometry(QRect(10,50,140,20))

        self.ExternalInhibitCheckBox = QCheckBox(self.CheckSettingsButtonGroup,"ExternalInhibitCheckBox")
        self.ExternalInhibitCheckBox.setGeometry(QRect(10,80,140,20))

        self.OffsetYGroupBox = QGroupBox(self,"OffsetYGroupBox")
        self.OffsetYGroupBox.setEnabled(0)
        self.OffsetYGroupBox.setGeometry(QRect(220,80,150,40))

        self.OffsetYSpinBox = QSpinBox(self.OffsetYGroupBox,"OffsetYSpinBox")
        self.OffsetYSpinBox.setGeometry(QRect(10,10,50,21))
        self.OffsetYSpinBox.setMaxValue(999)

        self.OffsetYTextLabel = QLabel(self.OffsetYGroupBox,"OffsetYTextLabel")
        self.OffsetYTextLabel.setGeometry(QRect(70,10,70,25))

        self.TimeOutGroupBox = QGroupBox(self,"TimeOutGroupBox")
        self.TimeOutGroupBox.setGeometry(QRect(20,80,180,40))

        self.TimeOutTextLabel = QLabel(self.TimeOutGroupBox,"TimeOutTextLabel")
        self.TimeOutTextLabel.setGeometry(QRect(80,10,80,21))

        self.TimeOutSpinBox = QSpinBox(self.TimeOutGroupBox,"TimeOutSpinBox")
        self.TimeOutSpinBox.setGeometry(QRect(10,10,61,20))
        self.TimeOutSpinBox.setMaxValue(600)
        self.TimeOutSpinBox.setMinValue(100)
        self.TimeOutSpinBox.setLineStep(50)

        self.DisplayIntervalGroupBox = QGroupBox(self,"DisplayIntervalGroupBox")
        self.DisplayIntervalGroupBox.setGeometry(QRect(330,210,180,50))

        self.DisplayIntervalTextLabel = QLabel(self.DisplayIntervalGroupBox,"DisplayIntervalTextLabel")
        self.DisplayIntervalTextLabel.setGeometry(QRect(20,20,80,21))

        self.DisplayIntervalSpinBox = QSpinBox(self.DisplayIntervalGroupBox,"DisplayIntervalSpinBox")
        self.DisplayIntervalSpinBox.setGeometry(QRect(110,20,50,21))
        self.DisplayIntervalSpinBox.setMaxValue(1200)
        self.DisplayIntervalSpinBox.setLineStep(5)

        self.line2 = QFrame(self,"line2")
        self.line2.setGeometry(QRect(10,190,540,20))
        self.line2.setFrameShape(QFrame.HLine)
        self.line2.setFrameShadow(QFrame.Sunken)
        self.line2.setLineWidth(2)
        self.line2.setFrameShape(QFrame.HLine)

        self.BinningGroupBox = QGroupBox(self,"BinningGroupBox")
        self.BinningGroupBox.setGeometry(QRect(330,270,180,50))

        self.BinningCheckBox = QCheckBox(self.BinningGroupBox,"BinningCheckBox")
        self.BinningCheckBox.setGeometry(QRect(30,20,120,20))

        self.RoiGroupBox = QGroupBox(self,"RoiGroupBox")
        self.RoiGroupBox.setGeometry(QRect(20,220,270,100))
        RoiGroupBox_font = QFont(self.RoiGroupBox.font())
        self.RoiGroupBox.setFont(RoiGroupBox_font)

        self.StartColTextLabel = QLabel(self.RoiGroupBox,"StartColTextLabel")
        self.StartColTextLabel.setGeometry(QRect(10,30,70,20))

        self.EndColTextLabel = QLabel(self.RoiGroupBox,"EndColTextLabel")
        self.EndColTextLabel.setGeometry(QRect(200,30,63,20))

        self.StartRowTextLabel = QLabel(self.RoiGroupBox,"StartRowTextLabel")
        self.StartRowTextLabel.setGeometry(QRect(20,60,60,20))

        self.EndRowTextLabel = QLabel(self.RoiGroupBox,"EndRowTextLabel")
        self.EndRowTextLabel.setGeometry(QRect(200,60,60,20))

        self.StartColSpinBox = QSpinBox(self.RoiGroupBox,"StartColSpinBox")
        self.StartColSpinBox.setGeometry(QRect(80,30,50,20))
        self.StartColSpinBox.setMaxValue(4095)
        self.StartColSpinBox.setLineStep(128)

        self.StartRowSpinBox = QSpinBox(self.RoiGroupBox,"StartRowSpinBox")
        self.StartRowSpinBox.setGeometry(QRect(80,60,50,20))
        self.StartRowSpinBox.setMaxValue(4095)
        self.StartRowSpinBox.setLineStep(128)

        self.EndColSpinBox = QSpinBox(self.RoiGroupBox,"EndColSpinBox")
        self.EndColSpinBox.setGeometry(QRect(140,30,50,20))
        self.EndColSpinBox.setMaxValue(4095)
        self.EndColSpinBox.setLineStep(128)
        self.EndColSpinBox.setValue(512)

        self.EndRowSpinBox = QSpinBox(self.RoiGroupBox,"EndRowSpinBox")
        self.EndRowSpinBox.setGeometry(QRect(140,60,50,20))
        self.EndRowSpinBox.setMaxValue(4095)
        self.EndRowSpinBox.setLineStep(128)
        self.EndRowSpinBox.setValue(512)

        self.buttonClose = QPushButton(self,"buttonClose")
        self.buttonClose.setGeometry(QRect(20,360,80,26))
        self.buttonClose.setAutoDefault(1)

        self.buttonDownload = QPushButton(self,"buttonDownload")
        self.buttonDownload.setGeometry(QRect(110,360,100,26))
        self.buttonDownload.setAutoDefault(1)
        self.buttonDownload.setDefault(1)

        self.buttonSaveAsDefaults = QPushButton(self,"buttonSaveAsDefaults")
        self.buttonSaveAsDefaults.setGeometry(QRect(400,360,140,26))
        self.buttonSaveAsDefaults.setAutoDefault(1)

        self.buttonSave = QPushButton(self,"buttonSave")
        self.buttonSave.setGeometry(QRect(310,360,80,26))
        self.buttonSave.setAutoDefault(1)
        
        if( self.readonly == 1):
            self.buttonDownload.setEnabled( 0 );
            self.buttonSave.setEnabled( 0 );
            self.buttonSaveAsDefaults.setEnabled( 0 );
            self.ResolutionComboBox.setEnabled( 0 );

        self.line2_2 = QFrame(self,"line2_2")
        self.line2_2.setGeometry(QRect(10,330,540,20))
        self.line2_2.setFrameShape(QFrame.HLine)
        self.line2_2.setFrameShadow(QFrame.Sunken)
        self.line2_2.setLineWidth(2)
        self.line2_2.setFrameShape(QFrame.HLine)

        self.StatTimerGroupBox = QGroupBox(self,"StatTimerGroupBox")
        self.StatTimerGroupBox.setEnabled(0)
        self.StatTimerGroupBox.setGeometry(QRect(330,140,200,40))

        self.StatTimerLengthSpinBox = QSpinBox(self.StatTimerGroupBox,"StatTimerLengthSpinBox")
        self.StatTimerLengthSpinBox.setGeometry(QRect(10,10,50,20))
        self.StatTimerLengthSpinBox.setMaxValue(30)
        self.StatTimerLengthSpinBox.setValue(5)

        self.StatTimerLengthTextLabel = QLabel(self.StatTimerGroupBox,"StatTimerLengthTextLabel")
        self.StatTimerLengthTextLabel.setGeometry(QRect(70,10,120,21))

        self.FiniteTimeGroupBox = QGroupBox(self,"FiniteTimeGroupBox")
        self.FiniteTimeGroupBox.setGeometry(QRect(30,130,270,50))

        self.EnableFiniteTimeCheckBox = QCheckBox(self.FiniteTimeGroupBox,"EnableFiniteTimeCheckBox")
        self.EnableFiniteTimeCheckBox.setGeometry(QRect(190,20,60,21))

        self.FinteTimeTextLabel = QLabel(self.FiniteTimeGroupBox,"FinteTimeTextLabel")
        self.FinteTimeTextLabel.setGeometry(QRect(20,20,73,21))

        self.FiniteTimeSpinBox = QSpinBox(self.FiniteTimeGroupBox,"FiniteTimeSpinBox")
        self.FiniteTimeSpinBox.setGeometry(QRect(100,20,85,21))
        self.FiniteTimeSpinBox.setMaxValue(999999999)
        self.FiniteTimeSpinBox.setLineStep(10)

        self.languageChange()

        self.resize(QSize(562,402).expandedTo(self.minimumSizeHint()))
        self.clearWState(Qt.WState_Polished)

        self.connect(self.buttonSave,SIGNAL("clicked()"),self.Save )
        self.connect(self.buttonSaveAsDefaults,SIGNAL("clicked()"),self.SaveDefaults )
        self.connect(self.buttonDownload,SIGNAL("clicked()"),self.Download )
        self.connect(self.buttonClose,SIGNAL("clicked()"),self, SLOT("close()") )
        self.connect(self.InterruptionTimerCheckBox,SIGNAL("clicked()"),self.updateDialog)
        self.connect(self.ResolutionComboBox,SIGNAL("activated(int)"),self.updateDialog)
        self.connect(self.EnableFiniteTimeCheckBox,SIGNAL("clicked()"),self.updateDialog)
        self.connect(self.TestRadioButton,SIGNAL("clicked()"),self.updateDialog)
        self.connect(self.NormalRadioButton,SIGNAL("clicked()"),self.updateDialog)
        self.connect(self.FiniteTimeSpinBox,SIGNAL("valueChanged(int)"),self.updateDialog)
        
        self.SetTdcSettings(self.cfg.ToTdcSettings() )
        self.SetRunSettings(self.cfg.ToRunSettings() )
        self.updateDialog()

        
    def SetRunSettings(self,set):
        if( set == [] or set is None ): return ;
        if( DBG == 1):
            print "ConfigC111Dialog.SetRunSettings(): ", set
        self.StartColSpinBox.setValue( set[self.glob.IDX_START_COL] )
        self.EndColSpinBox.setValue( set[self.glob.IDX_END_COL] )
        if( set[self.glob.IDX_END_COL] == 0 ):
            self.EndColSpinBox.setValue(512)
        self.StartRowSpinBox.setValue( set[self.glob.IDX_START_ROW] )
        self.EndRowSpinBox.setValue( set[self.glob.IDX_END_ROW] )
        if( set[self.glob.IDX_END_ROW] == 0 ):
            self.EndRowSpinBox.setValue(512)
        
        if( set[self.glob.IDX_ENABLE_FINITE_TIME] == 0):
            self.EnableFiniteTimeCheckBox.setChecked(0)
            self.FiniteTimeSpinBox.setEnabled(0)
            self.FiniteTimeSpinBox.setValue(0)
        else:
            self.EnableFiniteTimeCheckBox.setChecked(1)
            self.FiniteTimeSpinBox.setEnabled(1)
            self.FiniteTimeSpinBox.setValue( set[self.glob.IDX_FINITE_TIME_LENGTH] )

        self.DisplayIntervalSpinBox.setValue(set[self.glob.IDX_DISPLAY_UPDATE_INTERVAL] )
        if( set[self.glob.IDX_BINNING] == 1):
            self.BinningCheckBox.setChecked(1)
        else:
            self.BinningCheckBox.setChecked(0)

    def SetTdcSettings(self,set): 
        if( set == [] or set is None ): return ;
        self.TimeOutSpinBox.setValue(set[self.glob.IDX_TIMEOUT])
        if( set[self.glob.IDX_OPERATION_TYPE] == self.glob.TEST):
            self.TestRadioButton.setChecked(1)
        else:
            self.NormalRadioButton.setChecked(1)
        if( set[self.glob.IDX_EXT_INHIBIT] == 1):
            self.ExternalInhibitCheckBox.setChecked(1)
        self.OffsetXGroupBox.setEnabled(1)
        self.OffsetXSpinBox.setValue( set[self.glob.IDX_OFFSETX] )
        self.OffsetYGroupBox.setEnabled(1)
        self.OffsetYSpinBox.setValue( set[self.glob.IDX_OFFSETY] )
        
        if( set[self.glob.IDX_RESOLUTION] == 0):
            self.ResolutionComboBox.setCurrentItem(0)
        elif( set[self.glob.IDX_RESOLUTION] == 1):
            self.ResolutionComboBox.setCurrentItem(1)
        else:
            self.ResolutionComboBox.setCurrentItem(2)

        if( set[self.glob.IDX_INTERRUPT_TIMER] == 1):
            self.InterruptionTimerCheckBox.setChecked(1)
            self.StatTimerGroupBox.setEnabled(1)
            self.StatTimerLengthSpinBox.setValue( set[self.glob.IDX_STATS_TIMER_LENGTH] )

    def updateDialog(self):
        
        if( self.ResolutionComboBox.currentItem() == 0):
            self.TimeOutSpinBox.setMaxValue( 300 )
            self.EndColSpinBox.setMaxValue( self.glob.GFD_FULL_MAX_VALUE )
            self.EndRowSpinBox.setMaxValue( self.glob.GFD_FULL_MAX_VALUE )
        elif( self.ResolutionComboBox.currentItem() == 2):
            self.TimeOutSpinBox.setMaxValue( 1200 )
            self.EndColSpinBox.setMaxValue( self.glob.GFD_QUART_MAX_VALUE )
            self.EndRowSpinBox.setMaxValue( self.glob.GFD_QUART_MAX_VALUE )
        else:
            self.EndColSpinBox.setMaxValue( self.glob.GFD_HALF_MAX_VALUE )
            self.EndRowSpinBox.setMaxValue( self.glob.GFD_HALF_MAX_VALUE )
            self.TimeOutSpinBox.setMaxValue( 600 )

        # Statistic Timer
        # ~~~~~~~~~~~~~~~
        if (self.InterruptionTimerCheckBox.isChecked() == 1):
            self.StatTimerGroupBox.setEnabled(1)
        elif (self.InterruptionTimerCheckBox.isChecked() == 0):
            self.StatTimerGroupBox.setEnabled(0)
            self.StatTimerLengthSpinBox.setValue(0)
        
        if( self.TestRadioButton.isChecked() == 1 ):
            self.OffsetXGroupBox.setEnabled(0)
            self.OffsetXSpinBox.setValue(0)
            self.OffsetYGroupBox.setEnabled(0)
            self.OffsetYSpinBox.setValue(0)
            
        if( self.NormalRadioButton.isChecked() == 1 ):
            self.OffsetXGroupBox.setEnabled(1)
            #self.OffsetXSpinBox.setValue(0)
            self.OffsetYGroupBox.setEnabled(1)
            #self.OffsetYSpinBox.setValue(0)
               
        if( self.EnableFiniteTimeCheckBox.isChecked() == 1):
            self.FiniteTimeSpinBox.setEnabled(1)
            self.DisplayIntervalSpinBox.setValue( self.FiniteTimeSpinBox.value() + 1  )
            #self.FiniteTimeSpinBox.setValue(60)
        else:
            self.FiniteTimeSpinBox.setEnabled(0)
            self.FiniteTimeSpinBox.setValue(0)
        
        self.StartColSpinBox.setEnabled( 1 )
        self.EndColSpinBox.setEnabled( 1 )
        self.StartRowSpinBox.setEnabled( 1 )
        self.EndRowSpinBox.setEnabled( 1 )
            
    def guiToRunSettings(self):
        runset = ["DEVICE", 0 , 0 , 0 , 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        runset[self.glob.IDX_ROI] = 1
        runset[self.glob.IDX_START_COL] = self.StartColSpinBox.value()
        runset[self.glob.IDX_END_COL] = self.EndColSpinBox.value()
        if( runset[self.glob.IDX_END_COL] == 0):
            runset[self.glob.IDX_END_COL] = 512
        runset[self.glob.IDX_START_ROW] = self.StartRowSpinBox.value()
        runset[self.glob.IDX_END_ROW] = self.EndRowSpinBox.value()
        if( runset[self.glob.IDX_END_ROW] == 0):
            runset[self.glob.IDX_END_ROW] = 512
        
        ft = self.EnableFiniteTimeCheckBox.isChecked()
        if( ft == 1 ):
            runset[self.glob.IDX_ENABLE_FINITE_TIME] = 1
            runset[self.glob.IDX_FINITE_TIME_LENGTH] = self.FiniteTimeSpinBox.value()
        else:
            runset[self.glob.IDX_ENABLE_FINITE_TIME] = 0
            runset[self.glob.IDX_FINITE_TIME_LENGTH] = 0
            
        runset[self.glob.IDX_DISPLAY_UPDATE_INTERVAL] = self.DisplayIntervalSpinBox.value()

        if( self.BinningCheckBox.isChecked() == 1):
            runset[self.glob.IDX_BINNING] = 1
        else:
            runset[self.glob.IDX_BINNING] = 0
 
        return runset
        
            
    def guiToTdcSettings(self):
        tdc = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] ;
        tdc[self.glob.IDX_TIMEOUT] = self.TimeOutSpinBox.value()
        tdc[self.glob.IDX_OPERATION_MODE] = self.glob.GFD ;
        if( tdc[self.glob.IDX_TIMEOUT] == 0):
                tdc[self.glob.IDX_TIMEOUT] = self.glob.GFD_MAX_TIMEOUT ;
        if( self.TestRadioButton.isChecked() ): 
            tdc[self.glob.IDX_OPERATION_TYPE] = self.glob.TEST ;
        else: 
            tdc[self.glob.IDX_OPERATION_TYPE] = self.glob.NORMAL
        tdc[self.glob.IDX_ACQU_BANK] = 0
        if( self.ExternalInhibitCheckBox.isChecked() ):
            tdc[self.glob.IDX_EXT_INHIBIT] = 1
        else:
            tdc[self.glob.IDX_EXT_INHIBIT] = 0
        tdc[self.glob.IDX_PILEUPX] = 1
        tdc[self.glob.IDX_OFFSETX] = self.OffsetXSpinBox.value()
        tdc[self.glob.IDX_PILEUPY] = 1
        tdc[self.glob.IDX_OFFSETY] = self.OffsetYSpinBox.value()
        if( self.ResolutionComboBox.currentItem() == 0):
            tdc[self.glob.IDX_RESOLUTION] = 0
        elif( self.ResolutionComboBox.currentItem() == 1):
            tdc[self.glob.IDX_RESOLUTION] = 1
        else:
            tdc[self.glob.IDX_RESOLUTION] = 4
            
        tdc[self.glob.IDX_MONITOR] = self.glob.GATE 
            
        if( self.InterruptionTimerCheckBox.isChecked()):
            tdc[self.glob.IDX_INTERRUPT_TIMER] = 1
            tdc[self.glob.IDX_STATS_TIMER_LENGTH] = self.StatTimerLengthSpinBox.value()
        else:
            tdc[self.glob.IDX_INTERRUPT_TIMER] = 0
            tdc[self.glob.IDX_STATS_TIMER_LENGTH] = 0
        #print "guiToTdcSettings: TDC :", tdc 
        return( tdc )
        

    def Save(self ):
        if ( self.checkBeforeAction() == self.glob.BAD_CONFIG_CHOICE ):
            return    
        self.updateDialog()
        tdc = self.guiToTdcSettings( )
        run = self.guiToRunSettings( )
        self.cfg.FromTdcSettings( tdc )
        self.cfg.FromRunSettings( run )
        #self.cfg.PrintCfg()
        cfg_path = self.cfg.GetCfgDirPath()
        fname = QFileDialog.getSaveFileName(
                    cfg_path,
                    "Config files (*.cfg)", self, "Save config file dialog"
                    "Choose a filename to save under" )
        if fname.isEmpty():
            return
        d = string.split( str(fname), "/" )
        filename = "" 
        for i in range(len(d) -1):
            filename = filename + d[i] + "\\"
        filename = filename + d[len(d)-1]
        t = string.split( str(filename), ".")
        if( len(t) < 2):
            filename = filename + ".cfg"
        else:
            if ( t[1] != "cfg" and t[1] != "CFG"):
                filename = filename + ".cfg"
        self.cfg.SaveToFile(filename)
        s = "Configuration saved successfully to: \n" + filename + " "
        QMessageBox.information(self,"Information", s)
        
    def SaveDefaults(self):
        if ( self.checkBeforeAction() == self.glob.BAD_CONFIG_CHOICE ):
            return    
        self.updateDialog()
        user = getpass.getuser()
        user_path =  self.glob.CFG_PATH_USER + user + "\\"
        if( os.path.exists(user_path) == False ):
            save_path = self.glob.CFG_PATH_MAIN
        else:
            save_path = user_path
        om = self.cfg.GetRealOperationMode( )
        if( om != self.glob.GFD ): 
            return
        else:
            save_path = save_path + self.glob.CFG_DIR_GFD2D

        filename = "DefaultSettings.cfg" 
        print "DaveDefaults: ", save_path , ":  " , filename
        fname = save_path + filename
        self.cfg.SaveToFile(fname)
        s = "Configuration saved successfully to: \n" + fname + " "
        QMessageBox.information(self,"Information", s)
        

    def checkBeforeAction(self):
        return( self.glob.CONFIG_CHECK_OK )
                    
    def Download(self):
        
        if ( self.checkBeforeAction() == self.glob.BAD_CONFIG_CHOICE ):
            return
        self.updateDialog()
        tdc = self.guiToTdcSettings( )
        run = self.guiToRunSettings( )
        self.cfg.FromTdcSettings( tdc )
        self.cfg.FromRunSettings( run )
        self.cfg.DownloadToTdc( )
        s = "Configuration downloaded successfully to TDC : \n" 
        QMessageBox.information(self,"Information", s)

    def languageChange(self):
        self.setCaption(self.__tr("Configuration Dialog"))
        self.setCaption(self.cfg.GetName() )
        self.OperationTypeButtonGroup.setTitle(self.__tr("Operation Type"))
        self.NormalRadioButton.setText(self.__tr("Normal"))
        self.TestRadioButton.setText(self.__tr("Test"))
        self.OffsetXGroupBox.setTitle(QString.null)
        self.OffsetXTextLabel.setText(self.__tr("Offset X (ns)"))
        self.CheckSettingsButtonGroup.setTitle(self.__tr("Check settings"))
        #self.FullResolutionCheckBox.setText(self.__tr("Enable Full Resolution   "))
        self.InterruptionTimerCheckBox.setText(self.__tr("Enable Statistics Timer"))
        self.ExternalInhibitCheckBox.setText(self.__tr("Enable External Inhibit  "))
        self.OffsetYGroupBox.setTitle(QString.null)
        self.OffsetYTextLabel.setText(self.__tr("Offset Y (ns)"))
        self.TimeOutGroupBox.setTitle(QString.null)
        self.TimeOutTextLabel.setText(self.__tr("Time Out  (ns)"))
        self.DisplayIntervalGroupBox.setTitle(self.__tr("Display Update interval"))
        self.DisplayIntervalTextLabel.setText(self.__tr("Length in sec : "))
        self.BinningGroupBox.setTitle(self.__tr("Binning"))
        self.BinningCheckBox.setText(self.__tr("     Enable Binning  "))
        self.RoiGroupBox.setTitle(self.__tr("P/C111 Memory Area   "))
        self.StartColTextLabel.setText(self.__tr("Start Column  "))
        self.EndColTextLabel.setText(self.__tr("End Column  "))
        self.StartRowTextLabel.setText(self.__tr("Start Row"))
        self.EndRowTextLabel.setText(self.__tr("End Row"))
        self.buttonClose.setText(self.__tr("&Close"))
        self.buttonClose.setAccel(self.__tr("Alt+C"))
        self.buttonDownload.setText(self.__tr("&Apply"))
        self.buttonDownload.setAccel(self.__tr("Alt+A"))
        self.buttonSaveAsDefaults.setText(self.__tr("Save as Defaults "))
        self.buttonSaveAsDefaults.setAccel(QString.null)
        self.buttonSave.setText(self.__tr("&Save"))
        self.buttonSave.setAccel(self.__tr("Alt+S"))
        self.StatTimerGroupBox.setTitle(QString.null)
        self.StatTimerLengthTextLabel.setText(self.__tr("Statistic timer length (s)"))
        self.FiniteTimeGroupBox.setTitle(self.__tr("Acquisition with Finite Time"))
        self.EnableFiniteTimeCheckBox.setText(self.__tr("Enable "))
        self.FinteTimeTextLabel.setText(self.__tr("Length in sec : "))


    def __tr(self,s,c = None):
        return qApp.translate("NewDialog",s,c)